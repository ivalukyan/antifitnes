from src.db.router import conn, cursor


async def get_statistics_by_user(user_id, year_id):
    cursor.execute("""SELECT * FROM bot_app_statistics WHERE user_id=%s AND year=%s""", (user_id, year_id,))

    result = cursor.fetchall()

    message = ""
    if result is not None:
        for _ in result:
            if _[26] == '1':
                msg = (f"ü§∏‚Äç‚ôÇÔ∏è<b>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ –Ø–Ω–≤–∞—Ä—å</b>ü§∏‚Äç‚ôÇÔ∏è\n\n"
                       f"–ì—Ä–æ–º - {_[3]}\n"
                       f"–¢—É—Ä–µ—Ü–∫–∏–π –ø–æ–¥—ä–µ–º: –ê–∫—Å–µ–ª—å - {_[4]}\n"
                       f"–¢—É—Ä–µ—Ü–∫–∏–π –ø–æ–¥—ä–µ–º: –ì–∏—Ä—è - {_[5]}\n"
                       f"–ñ–∏–º –ª–µ–∂–∞ 1–ü–ú - {_[6]}\n"
                       f"–†—ã–≤–æ–∫ –∞–∫—Å–µ–ª—è 1–ü–ú - {_[7]}\n"
                       f"–í–∑—è—Ç–∏–µ –Ω–∞ –≥—Ä—É–¥—å –∞–∫—Å–µ–ª—è 1–ü–ú - {_[8]}\n"
                       f"–Ø–≥–æ–¥–∏—á–Ω—ã–π –º–æ—Å—Ç–∏–∫ 1–ü–ú - {_[9]}\n"
                       f"–°—Ç–∞–Ω–æ–≤–∞—è —Ç—è–≥–∞ 1–ü–ú - {_[10]}\n"
                       f"–†—ã–≤–æ–∫ 1–ü–ú - {_[11]}\n"
                       f"–í–∑—è—Ç–∏–µ –Ω–∞ –≥—Ä—É–¥—å 1–ü–ú - {_[12]}\n"
                       f"–°—Ç–∞–Ω–æ–≤–∞—è —Ç—è–≥–∞ –∞–∫—Å–µ–ª—è 1–ü–ú - {_[13]}\n"
                       f"–ü—Ä–∏—Å–µ–¥ 1–ü–ú: –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π - {_[14]}\n"
                       f"–ü—Ä–∏—Å–µ–¥ 1–ü–ú: –§—Ä–æ–Ω—Ç–∞–ª—å–Ω—ã–π - {_[15]}\n"
                       f"–ü—Ä–∏—Å–µ–¥ 1–ü–ú: –ù–∞–¥ –≥–æ–ª–æ–≤–æ–π - {_[16]}\n"
                       f"–°–∫–∞–∫–∞–ª–∫–∞ - {_[17]}\n"
                       f"–û—Ç–∂–∏–º–∞–Ω–∏—è –æ—Ç –ø–æ–ª–∞ - {_[18]}\n"
                       f"–ß–µ–ª–Ω–æ—á–Ω—ã–π –±–µ–≥ - {_[19]}\n"
                       f"–ü—Ä–æ–≥—É–ª–∫–∞ —Ñ–µ—Ä–º–µ—Ä–∞ - {_[20]}\n"
                       f"–ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è - {_[21]}\n"
                       f"–ü—Ä—ã–∂–æ–∫ –≤ –≤—ã—Å–æ—Ç—É - {_[22]}\n"
                       f"–ü—Ä—ã–∂–æ–∫ –≤ –¥–ª–∏–Ω—É - {_[23]}\n"
                       f"–£–¥–µ—Ä–∂–∞–Ω–∏–µ –∞–∫—Å–µ–ª—è - {_[24]}\n"
                       f"–°—Ç–æ–π–∫–∞ –Ω–∞ —Ä—É–∫–∞—Ö - {_[25]}\n")

                message += msg + "\n\n"

            elif _[26] == '4':
                msg = (f"üèÖ<b>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ –ê–ø—Ä–µ–ª—å</b>üèÖ\n\n"
                       f"–ì—Ä–æ–º - {_[3]}\n"
                       f"–¢—É—Ä–µ—Ü–∫–∏–π –ø–æ–¥—ä–µ–º: –ê–∫—Å–µ–ª—å - {_[4]}\n"
                       f"–¢—É—Ä–µ—Ü–∫–∏–π –ø–æ–¥—ä–µ–º: –ì–∏—Ä—è - {_[5]}\n"
                       f"–ñ–∏–º –ª–µ–∂–∞ 1–ü–ú - {_[6]}\n"
                       f"–†—ã–≤–æ–∫ –∞–∫—Å–µ–ª—è 1–ü–ú - {_[7]}\n"
                       f"–í–∑—è—Ç–∏–µ –Ω–∞ –≥—Ä—É–¥—å –∞–∫—Å–µ–ª—è 1–ü–ú - {_[8]}\n"
                       f"–Ø–≥–æ–¥–∏—á–Ω—ã–π –º–æ—Å—Ç–∏–∫ 1–ü–ú - {_[9]}\n"
                       f"–°—Ç–∞–Ω–æ–≤–∞—è —Ç—è–≥–∞ 1–ü–ú - {_[10]}\n"
                       f"–†—ã–≤–æ–∫ 1–ü–ú - {_[11]}\n"
                       f"–í–∑—è—Ç–∏–µ –Ω–∞ –≥—Ä—É–¥—å 1–ü–ú - {_[12]}\n"
                       f"–°—Ç–∞–Ω–æ–≤–∞—è —Ç—è–≥–∞ –∞–∫—Å–µ–ª—è 1–ü–ú - {_[13]}\n"
                       f"–ü—Ä–∏—Å–µ–¥ 1–ü–ú: –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π - {_[14]}\n"
                       f"–ü—Ä–∏—Å–µ–¥ 1–ü–ú: –§—Ä–æ–Ω—Ç–∞–ª—å–Ω—ã–π - {_[15]}\n"
                       f"–ü—Ä–∏—Å–µ–¥ 1–ü–ú: –ù–∞–¥ –≥–æ–ª–æ–≤–æ–π - {_[16]}\n"
                       f"–°–∫–∞–∫–∞–ª–∫–∞ - {_[17]}\n"
                       f"–û—Ç–∂–∏–º–∞–Ω–∏—è –æ—Ç –ø–æ–ª–∞ - {_[18]}\n"
                       f"–ß–µ–ª–Ω–æ—á–Ω—ã–π –±–µ–≥ - {_[19]}\n"
                       f"–ü—Ä–æ–≥—É–ª–∫–∞ —Ñ–µ—Ä–º–µ—Ä–∞ - {_[20]}\n"
                       f"–ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è - {_[21]}\n"
                       f"–ü—Ä—ã–∂–æ–∫ –≤ –≤—ã—Å–æ—Ç—É - {_[22]}\n"
                       f"–ü—Ä—ã–∂–æ–∫ –≤ –¥–ª–∏–Ω—É - {_[23]}\n"
                       f"–£–¥–µ—Ä–∂–∞–Ω–∏–µ –∞–∫—Å–µ–ª—è - {_[24]}\n"
                       f"–°—Ç–æ–π–∫–∞ –Ω–∞ —Ä—É–∫–∞—Ö - {_[25]}\n")

                message += msg + "\n\n"

            elif _[26] == '7':
                msg = (f"üèãÔ∏è‚Äç‚ôÄÔ∏è<b>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ –ò—é–ª—å</b>üèãÔ∏è‚Äç‚ôÄÔ∏è\n\n"
                       f"–ì—Ä–æ–º - {_[3]}\n"
                       f"–¢—É—Ä–µ—Ü–∫–∏–π –ø–æ–¥—ä–µ–º: –ê–∫—Å–µ–ª—å - {_[4]}\n"
                       f"–¢—É—Ä–µ—Ü–∫–∏–π –ø–æ–¥—ä–µ–º: –ì–∏—Ä—è - {_[5]}\n"
                       f"–ñ–∏–º –ª–µ–∂–∞ 1–ü–ú - {_[6]}\n"
                       f"–†—ã–≤–æ–∫ –∞–∫—Å–µ–ª—è 1–ü–ú - {_[7]}\n"
                       f"–í–∑—è—Ç–∏–µ –Ω–∞ –≥—Ä—É–¥—å –∞–∫—Å–µ–ª—è 1–ü–ú - {_[8]}\n"
                       f"–Ø–≥–æ–¥–∏—á–Ω—ã–π –º–æ—Å—Ç–∏–∫ 1–ü–ú - {_[9]}\n"
                       f"–°—Ç–∞–Ω–æ–≤–∞—è —Ç—è–≥–∞ 1–ü–ú - {_[10]}\n"
                       f"–†—ã–≤–æ–∫ 1–ü–ú - {_[11]}\n"
                       f"–í–∑—è—Ç–∏–µ –Ω–∞ –≥—Ä—É–¥—å 1–ü–ú - {_[12]}\n"
                       f"–°—Ç–∞–Ω–æ–≤–∞—è —Ç—è–≥–∞ –∞–∫—Å–µ–ª—è 1–ü–ú - {_[13]}\n"
                       f"–ü—Ä–∏—Å–µ–¥ 1–ü–ú: –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π - {_[14]}\n"
                       f"–ü—Ä–∏—Å–µ–¥ 1–ü–ú: –§—Ä–æ–Ω—Ç–∞–ª—å–Ω—ã–π - {_[15]}\n"
                       f"–ü—Ä–∏—Å–µ–¥ 1–ü–ú: –ù–∞–¥ –≥–æ–ª–æ–≤–æ–π - {_[16]}\n"
                       f"–°–∫–∞–∫–∞–ª–∫–∞ - {_[17]}\n"
                       f"–û—Ç–∂–∏–º–∞–Ω–∏—è –æ—Ç –ø–æ–ª–∞ - {_[18]}\n"
                       f"–ß–µ–ª–Ω–æ—á–Ω—ã–π –±–µ–≥ - {_[19]}\n"
                       f"–ü—Ä–æ–≥—É–ª–∫–∞ —Ñ–µ—Ä–º–µ—Ä–∞ - {_[20]}\n"
                       f"–ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è - {_[21]}\n"
                       f"–ü—Ä—ã–∂–æ–∫ –≤ –≤—ã—Å–æ—Ç—É - {_[22]}\n"
                       f"–ü—Ä—ã–∂–æ–∫ –≤ –¥–ª–∏–Ω—É - {_[23]}\n"
                       f"–£–¥–µ—Ä–∂–∞–Ω–∏–µ –∞–∫—Å–µ–ª—è - {_[24]}\n"
                       f"–°—Ç–æ–π–∫–∞ –Ω–∞ —Ä—É–∫–∞—Ö - {_[25]}\n")

                message += msg + "\n\n"

            elif _[26] == '10':
                msg = (f"<b>üèÜ–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ –û–∫—Ç—è–±—Ä—å</b>üèÜ\n\n"
                       f"–ì—Ä–æ–º - {_[3]}\n"
                       f"–¢—É—Ä–µ—Ü–∫–∏–π –ø–æ–¥—ä–µ–º: –ê–∫—Å–µ–ª—å - {_[4]}\n"
                       f"–¢—É—Ä–µ—Ü–∫–∏–π –ø–æ–¥—ä–µ–º: –ì–∏—Ä—è - {_[5]}\n"
                       f"–ñ–∏–º –ª–µ–∂–∞ 1–ü–ú - {_[6]}\n"
                       f"–†—ã–≤–æ–∫ –∞–∫—Å–µ–ª—è 1–ü–ú - {_[7]}\n"
                       f"–í–∑—è—Ç–∏–µ –Ω–∞ –≥—Ä—É–¥—å –∞–∫—Å–µ–ª—è 1–ü–ú - {_[8]}\n"
                       f"–Ø–≥–æ–¥–∏—á–Ω—ã–π –º–æ—Å—Ç–∏–∫ 1–ü–ú - {_[9]}\n"
                       f"–°—Ç–∞–Ω–æ–≤–∞—è —Ç—è–≥–∞ 1–ü–ú - {_[10]}\n"
                       f"–†—ã–≤–æ–∫ 1–ü–ú - {_[11]}\n"
                       f"–í–∑—è—Ç–∏–µ –Ω–∞ –≥—Ä—É–¥—å 1–ü–ú - {_[12]}\n"
                       f"–°—Ç–∞–Ω–æ–≤–∞—è —Ç—è–≥–∞ –∞–∫—Å–µ–ª—è 1–ü–ú - {_[13]}\n"
                       f"–ü—Ä–∏—Å–µ–¥ 1–ü–ú: –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π - {_[14]}\n"
                       f"–ü—Ä–∏—Å–µ–¥ 1–ü–ú: –§—Ä–æ–Ω—Ç–∞–ª—å–Ω—ã–π - {_[15]}\n"
                       f"–ü—Ä–∏—Å–µ–¥ 1–ü–ú: –ù–∞–¥ –≥–æ–ª–æ–≤–æ–π - {_[16]}\n"
                       f"–°–∫–∞–∫–∞–ª–∫–∞ - {_[17]}\n"
                       f"–û—Ç–∂–∏–º–∞–Ω–∏—è –æ—Ç –ø–æ–ª–∞ - {_[18]}\n"
                       f"–ß–µ–ª–Ω–æ—á–Ω—ã–π –±–µ–≥ - {_[19]}\n"
                       f"–ü—Ä–æ–≥—É–ª–∫–∞ —Ñ–µ—Ä–º–µ—Ä–∞ - {_[20]}\n"
                       f"–ü–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏—è - {_[21]}\n"
                       f"–ü—Ä—ã–∂–æ–∫ –≤ –≤—ã—Å–æ—Ç—É - {_[22]}\n"
                       f"–ü—Ä—ã–∂–æ–∫ –≤ –¥–ª–∏–Ω—É - {_[23]}\n"
                       f"–£–¥–µ—Ä–∂–∞–Ω–∏–µ –∞–∫—Å–µ–ª—è - {_[24]}\n"
                       f"–°—Ç–æ–π–∫–∞ –Ω–∞ —Ä—É–∫–∞—Ö - {_[25]}\n")

                message += msg + "\n\n"

        return message

    else:
        "C—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –≥–æ–¥ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç"
